Revision history for Net::DNS                                     -*-text-*-
=============================


*** 0.49_02  May 28, 2005  (Version 0.50 release candidate 2)

Fix: Smoking Gun tests for non-cygwin Win32.
      Makefile.PL failed to produce a proper Makefile under win32.
      (e.g. www,nntp.perl.org/group/perl.cpan.testers/210570)
      I worked around that by moving the library into the base
      directory of the distribution as the "subdir" section 
      seemed to be all funny.

Fix: rt.cpan.org#11931 (the off-topic part)

      Sidney Markovitz spotted an awkward condition that rarely happens but is
      significant enough to be dealt with.

      In the send_udp method there are two loops: one over the nameservers
      and one that waits for the sockets to come forward with data.

      That second loop will sometimes timeout and then be entered with a 
      repeated query to the same nameserver. It occasionally happens that the
      old packet arrives on the socket. That packet is discarded but the 
      loop does not return to the loop to wait for the remainder of the
      timeout period for an answer on the second query, that may still arrive.
      This has now been fixed.

      Thanks to Sidney for the assessment of the problem and the fix.



*** 0.49_01    (Version 0.50 release candidate 1)

Fix: Makefile.PL: Minor tweak to recognize Mac OS X 10.4 not so relevant
    since netdnslib is distributed with the code.

Feature: Calling the Net::DNS::Resolver::dnssec method with a non-zero
    argument will set the udppacketsize to 2048. The method will
    also carp a warning if you pass a non-zero argument when
    Net::DNS::SEC is not installed.


Feature: IPv6 transport support
     
     IPv6 transport has been added to the resolver and to the
     nameserver code.
 
     To use IPv6 please make sure that you have IO::Socket::INET6 version
     2.01 or later installed.

     If IPv6 transport is available Net::DNS::Resolver::Recurse will make
     use of it (picking randomly between IPv4 and IPv6 transport) use
     the force_v4() method to only force IPv4.



Feature: Binary characters in labels

     RFC 1035 3.1:
     
       Domain names in messages are expressed in terms of a sequence of
       labels.  Each label is represented as a one octet length field
       followed by that number of octets.  Since every domain name ends
       with the null label of the root, a domain name is terminated by a
       length byte of zero.  The high order two bits of every length octet
       must be zero, and the remaining six bits of the length field limit
       the label to 63 octets or less.
     
     Unfortunatelly dname attributes are stored strings throughout
     Net::DNS.  (With hindsight dnames should have had their own class
     in which one could have preserved the wire format.).
     
     To be able to represent all octets that are allowed in domain
     names I took the approach to use the "presentation format" for
     the attributes. This presentation format is defined in RFC 1035
     5.1.
     
     I added code to parse presentation format domain names that has
     escpaped data such as \ddd and \X (where X is not a number) to
     wireformat and vice verse. In the conversion from wire format to
     presentation format the characters that have special meaning in a
     zone file are escaped (so that they can be cut-n-pasted without
     pain).
     
     These are " (0x22), $ (0x24), (0x28), ) (0x29), . (0x2e) , ;
     (0x3b), @ (ox40) and \ (0x5c). The number between brackets
     representing the ascii code in hex.
     
     Note that wherever a name occurs as a string in Net::DNS it is
     now in presentation format.
     
     For those that dealth with 'hostnames' (subset of all possible
     domain names) this will be a completely transparent change.
     
     Details:
     
     I added netdnslib wich contains Net::DNS's own dn_expand. Its
     implemented in C and the source is a hodgepodge of Berkeley based
     code and sniplets from ISC's bind9 distribution. The behavior, in
     terms of which chars are escaped, is similare to bind9.
     
     There are some functions added to DNS.pm that do conversion from
     presentation and wire format and back. They should only be used
     internally (although they live in EXPORT_OK.)
     
     
     For esotheric test cases see t/11-escapedchars.t.
 
Fix: rt.cpan.org #11931 
     Applied the patch suggested by "Sidney". It is a practical workaround
     that may not be portable to all versions of the OS from Redmond. See
     the ticket for details.



*** 0.49 March 29, 2005

     No changes wrt 0.49_03.
 

*** 0.48_03 March 22, 2005 (Version 0.49 release candidate 3)

Fix: Only remove leading zeros in the regular expressions for typesbyval
     and classbyval methods. (patch by Ronald v.d. Pol)

Fix: Properly return an empty array in the authority, additional and answer
     methods (patch by Ronald v.d. Pol)


Fix: rt.cpan.org #11930 
     Incorrect searchlist duplication removal in Net::DNS::Resolver::Win32 
     Patch courtesy Risto Kankkunen.

Problem: rt.cpan.org #11931

     Win32.pm used the DNSRegisteredAdapters registry key to determine which
     local forwarders to send queries to. This is arguably the wrong key as it
     is used to identify the server which to send dynamic updates to.

     A real fix for determining the set of nameservers to query has not been
     implemented. For details see 
     https://rt.cpan.org/Ticket/Display.html?id=11931


*** 0.48_02 March 14, 2005 (Version 0.49 release candidate 2)

Fix: Bug report by Bernhard Schmidt (concerning a bug on the IPv6 branch).

      The bug caused dname compression to fail and to create
      compression pointers causing loops.

*** 0.48_01 March 7, 2005 (Version 0.49 release candidate 1)


Fix: rt.cpan.org  #8882  
      No redundant lookups on SERVFAIL response 
      and #6149 	 
      Does not search multiple DNS servers
 
      Net::DNS::Resolver will now use the other nameservers in the
      list if the RCODE of the answer is not NO ERROR (0) or NAME
      ERROR (3). When send() exhausted the last nameserver from the it
      will return the answer that was received from the last
      nameserver that responded with an RCODE.

      The error string will be set to "RCODE: <rcode from last packet>"


Fix: rt.cpan.org #8803  

      TXT records don't work with semicolons 

      Since we are expecting presentation format at input a comment
      will need to be escaped ( \; ).

      It could be argued that this is a to strict interpretation of 
      1035 section 5.1.

      While working on this I discovered there are more problems with
      TXT RRs. e.g.; '0100' (a character string content represented in
      hex) is a perfectly legal and should be represented as "\000" in
      presentation format. Net::DNS does pass character strings with
      "non-ASCII" chars from the wire to the char_str_lst array but
      the print functions do not properly escape them when printing.

      Some tests with TXT RRs added to 07-misc.t

      Properly dealing with zone file presentation format and binary 
      data is still to be done.


Fix: rt.cpan.org Ticket #8483 
	eval tests for DNS::RR::SIG fail when using a die handler 
	(Thanks Sebastiaan Hoogeveen)
	
      Patch applied.

Fix: rt.cpan.org: Ticket #8608 
	Net::DNS::Packet->data makes incorrect assumptions

      Implemented the "pop" method for the question.
      Since having a qcount that is not 1 is somewhat rare (it appears
      in TCP AXFR streams) the ability to pop the answer from a question
      has not been documented in the "pod"

      Also fixed the incorrect assumption.

      (Thanks Bruce Campbell.)


Fix: Ticket #11106 
      Incorrect instructions in README 

      Corrected in the README and in Makefile.PL


Olaf Kolkman took over maintenance responsibility from Chris
Reinardt. This involved importing the code into another subversion
repository. I made sure the numbers jumped, but I did not have access
to the "original" subversion repository so I lost some of the history.


*** 0.48_01 March 2005 (Version 0.49 release candidate 1)


Fix: rt.cpan.org  #8882  
      No redundant lookups on SERVFAIL response 
     and #6149 	 
      Does not search multiple DNS servers
 
      Net::DNS::Resolver will now use the other nameservers in the
      list if the RCODE of the answer is not NOERROR (0) or NXDOMAIN
      (3). When send() exhausted the last nameserver from the it will
      return the answer that was received from the last nameserver
      that responded with an RCODE.

      The errorstring will be set to "RCODE: <rcode from last packet>"


Fix: rt.cpan.org #8803 
      TXT records don't work with semicolons 

      Since we are expecting "zonefile" presentation at input 
      a comment will need to be escaped ( \; ).

      It could be argued that this is a to strict interpertation of 
      1035 section 5.1.

      While working on this I discovered there are more problems with
      TXT RRs. Eg; 0100 is a perfectly legal character string that
      should be represented as "\000" in a zonefile. Net::DNS does 
      pass character strings with "non-ASCII" chars from the wire
      to the char_str_lst array but the print functions do not
      properly escape them when prining.

      Properly dealing with zonefile presentation format and binary 
      data is still to be done.


Fix: rt.cpan.org Ticket #8483 
	eval tests for DNS::RR::SIG fail when using a die handler 
	(Thanks Sebastiaan Hoogeveen)
	
      Patch applied.

Fix: rt.cpan.org: Ticket #8608 
	Net::DNS::Packet->data makes incorrect assumptions

      Implemented the "pop" method for the question.
      Since having a qcount that is not 1 is somewhat rare (it appears
      in TCP AXFR streams) the ability to pop the answer from a question
      has not been documented in the "pod"

      Also fixed the incorrect assumption.

      (Thanks Bruce Campbell.)


Fix: Ticket #11106 
      Incorrect instructions in README 

      Corrected in the README and in Makefile.PL


Olaf Kolkman took over maintenance responsibility from Chris
Reinardt. This involved importing the code into another subversion
repository. I made sure the numbers jumped, but I did not have access
to the "original" subversion repository so I lost some of the history.


>>>>>>> .merge-right.r260
*** 0.48 Aug 12, 2004


Net::DNS is now stored in a subversion repository, replacing cvs.
As such the submodule version numbers have taken another big jump. 
Luckily those numbers don't matter as long as they work.

Fixed a bug with Unknown RR types that broke zone signing [Olaf].

Added callback support to Net::DNS::Resolver::Recuse.  The
demo/trace_dns.pl script demonstrates this.

Added a note regarding answers with an empty answer section to the 
Net::DNS::Resolver::search() and Net::DNS::Resolver::query() 
documentation.

The copyright notice for Net::DNS::RR::SSHFP was incorrect.  That file
is Copyright (c) 2004 RIPE NCC, Olaf Kolkman.

*** 0.47_01 May 6, 2004

** NOTICE **

RR subclasses no longer pull in parts of Net::DNS; Net::DNS is assumed
to be up and running when the subclass is compiled.  If you were using a
RR subclass directly, this may break your code.  It was never documented
that you could use them directly however, so hopefully you never did...

Fixed bug where SRV records with a priority of 0 did not function 
correctly.  CPAN #6214

Calls to various constants where using the &NAME syntax, which is not
inlined.  Changed to NAME().

Added SSHFP support. [Olaf]

CERT fixes.  [Olaf]

*** 0.47 April 1, 2004

safe_push() is back in Net::DNS::Packet, due to the excellent debate
skills of Luis E Monoz.  However, the name safe_push() is deprecated,
use the new name unique_push() instead.

Fixed a bug in Net::DNS::Nameserver which caused the class to build 
packets incorrectly in some cases. [Ask Bjorn Hansen]

Error message cleanups in Net::DNS::typesbyname()
and Net::DNS::typesbyval() [Ask Bjorn Hansen]

Net::DNS::RR::new_from_hash() now works with unknown RR types [Olaf].

*** 0.46 February 21, 2004

IPv6 reverse lookups can now be done with Net::DNS::Resolver::search(),
as well as with query().

Hostnames can now be used in the 'nameservers' arguement to 
Net::DNS::Resolver->new()

*** 0.45_01 February 9, 2004

Net::DNS now uses UDP on windows.

Removed Net::DNS::Select from the package.  IO::Select appears to work
on windows just fine.

Fixed a bug that caused MXes with a preference of 0 to function
incorrectly, reported by Dick Franks.

Net::DNS had a few problems running under taint mode, especially under
cygwin.  These issues have been fixed.  More issues with taint mode may
lay undiscovered.

Applied Matthew Darwin's patch added support for IPv6 reverse lookups to
Net::DNS::Resolver::query.

*** 0.45 January 8, 2004

No changes from 0.44_02.

** 0.44_02 January 3, 2004

The XS detection code was broken.  We actually use the XS bits now.

Major cleanups/optimizations of the various RR subclasses.  This release
of Net::DNS is over twice as fast at parsing dns packets as 0.44.

** NOTICE **

$rr->rdatastr no longer returns '; no data' if the RR record has no
data.  This happens in $rr->string now.

Net::DNS::Packet::safe_push() no longer exists.  The method is now only 
avalible from Net::DNS::Update objects.


** 0.44_01 January 3, 2004

Net::DNS::RR objects were not playing nice with Storable, this caused 
the axfr demo script to fail.  Thanks to Joe Dial for the report.

** NOTICE **
This may cause RR objects that are already serialize to not deserialize
correctly.  

Reply handlers in Net::DNS::Nameserver are now passed the query object.

Fixed a nasty bug in Nameserver.pm related to the qr bit.  As Olaf
explained:

  Replies are sent if the query has its "qr" bit set. The "qr" bit is an
  indication that the packet is sent as a response to a query. Since
  there are more implementations that suffer from this bug one can cause
  all kinds of nasty ping-pong loops by spoofing the initial packet or
  have an infinite query loop by spoofing a query from the localhost:53
  address.

Various Win32/Cygwin cleanups from Sidney Markowitz.


*** 0.44 December 12, 2003

	The Wrath of CPAN Release.
	
CPAN.pm doesn't understand the nature of revision numbers.  1.10 is 
newer than 1.9; but CPAN.pm treats them as floats.  This is bad.
All the internal version numbers in Net::DNS have been bumped to
2.100 in order to fix this.

No actual code changes in this release.


*** 0.43 December 11, 2003

Added warning of deprecation of Net::DNS::Packet::safe_push.  This will
move into Net::DNS::Update, as Net::DNS::Update is now a proper subclass
of Net::DNS::Packet.

** 0.42_02 December 11, 2003

Fixed a long standing bug with zone transfers in the "many-answers" format. 
CPAN #1903.

Added the '--online-tests' flag to Makefile.PL.  This activates the online
tests without asking the user interactively.  "--no-online-tests" turns
the tests off.  

Cleaned up Makefile.PL a little.  The "--pm" flag is now deprecated, use
"--no-xs" instead.

Added support for unknown RR types (rfc3597). Note for developers: the
typesbyname, typesbyval, classesbyname and classesbyval hashes should
not be used directly, use the same named wrapper functions
instead. [Olaf Kolkman]

Added two hashes for administrative use; they store which types are
qtypes and metatypes (rfc2929). [Olaf Kolkman]

** 0.42_01 November 30, 2003

Major work to get Net::DNS functioning properly on Cygwin by Sidney 
Markowitz.

Fixed a bug in Net::DNS::Nameserver's error handling.  CPAN #4195

*** 0.42 October 26, 2003

Fixed compilation problems on panther (Mac OS 10.3).

Fixed a bug in Net::DNS::Resolver::Recurse which allowed an endless
loop to arise in certain situations.  (cpan #3969, patch
by Rob Brown) 

Applied Mike Mitchell's patch implementing a presistant UDP socket.  
See the Net::DNS::Resolver documentation for details.

*** 0.41 October 3, 2003

Added some documentation about modifying the behavior of Net::DNS::Resolver. 

** 0.40_01 September 26, 2003

Fixed some uninitialized value warnings when running under windows.

Fixed a bug in the test suite that caused 00-version.t to fail with
certain versions of ExtUtils::MakeMaker.   Thanks to David James, Jos 
Boumans and others for reporting it.

Reply handlers in Net::DNS::Nameserver are now passed the peerhost.
(Assen Totin <assen@online.bg>)

Reply handlers in Net::DNS::Nameserver can now tweak the header bits
that the nameserver returns.  [Olaf]

The AD header bit is now documented, and twiddleable. [Olaf]

The change log has been trimmed, entries for versions older than 0.21
have been removed. 

** NOTICE **
Net::DNS::Resolver::axfr_old() has been removed from the package.  
An exception will be thrown if you attempt to use this method.  Use
axfr() or axfr_start() instead.

*** 0.40 September 1, 2003

Various POD tweaks.

** 0.39_02 August 28, 2003

Net-DNS-SEC updates, seems that IETF has been busy redefining DNSSEC.
[Olaf]

Added version to all the modules in the distribution.

** 0.39_01 August 12 2003

Added a META.yaml.  The crystal ball says an upgrade to Module::Install may
be coming soon.

Changed how the versions of the various submodules were set.  The CPAN 
indexer cannot execute "$VERSION = $Net::DNS::VERSION".  The single line
with the $VERSION assignment is pulled out of the file and eval'ed; at
that time, Net::DNS is not loaded.  The submodules now pull their version 
numbers out of CVS.

*** 0.39 August 7 2003

Fixed a bug on Win32 where some machines seperated lists with commas, 
not whitespace.  Thanks to Jim White for pointing it out.

** 0.38_02 July 29 2003

Reworked the POD for Net::DNS::Resolver.

When parsing resolver configuration files, IPv6 addresses are now skipped,
as Net::DNS does not yet have IPv6 support. 

** 0.38_01 Jun 22 2003

Broke Net::DNS::Resolver into seperate classes.  UNIX and Win32 
classes are currently implemented.  Many of the globals in 
Net::DNS::Resolver no longer exist.  They were never documented
so you never used them.... right?
 
Options to Net::DNS::Resolver->new() are now supported, including
using your own configuration file.  See the Net::DNS::Resolver man
page for details.

Tweaked Net::DNS::RR::TXT to fail more gracefully when the quotes 
in the data section are not balanced.

Add more tests (of course).

Moved next_id() from Resolver.pm to Header.pm (which is where it is
used).

Net::DNS::Select now uses $^O directly, this means that the second
argument to Net::DNS::Select::new() (the OS) is now ignored.

*** 0.38 Jun 5 2003

Various buglets fixed in the new Makefile.PL.

Use Dynaloader instead of XSLoader.  Turns out that XSLoader is only 
in more recent perls.

Added deprecation warning to Net::DNS::Resolver::axfr_old().

HP-UX fixes [cpan #2710], I don't have the name of the reporter/patcher.

*** 0.37 May 28 2003

Renamed the test C file to compile.c, test.c was confusing the 'make test'
target.

*** 0.36 May 28 2003

Removed Rob Brown's RPM stuff.  Something odd happened in the 0.35 tarball
and at the moment I don't have the time to investigate.

*** 0.35 May 26 2003

POD fixes, added tests for POD.

*** 0.34_03 May 22 2003

Reworked Makefile.PL to try and detect if you have a working C compiler.

Added '--pm' and '--xs' command line options to Makefile.PL

Fixed linking problem on linux.

Tie::DNSHash removed from the package, see Tie::DNS from CPAN for a more
complete implementation of a DNS hash.

*** 0.34_02 May 21 2003

Net::DNS::Packet::dn_expand is now implemented using the function of the
same name from libresolv.  This method of decompressing names is around
twice as fast as the perl implementation.

Applied Jan Dubois's patch to fix nameserver lookup on Windows 2000/95/98/ME.

*** 0.34 6 Mar 2003

Applied David Carmean's patch for handling more than one string in a 
TXT RR's RDATA section.

Applied Net::DNS::Resolver::Recurse bug fixes from Rob Brown.

Added check of the answer's rcode in Net::DNS::Resolver::axfr_next().

Applied Kenneth Olving <kenneth.olving@eoncompany.com> Windows changes.

Applied patch from Dan Sully (daniel@electricrain.com) allowing multiple
questions to be part of a DNS packet.

*** 0.33 8 Jan 2003

Fixed 00-load.t to skip the Net::DNS::SEC modules.  The test suite
should now pass if you have Net::DNS::SEC installed. 

Fixed the regular expression in RR.pm to comply with the RFCs, turns
out we were _too_ paranoid.  [Olaf]


*** 0.32 5 Jan 2003

Various cleanups for perl 5.004.  Thanks to nathan@anderson-net.com
([cpan #1847])

Applied Olaf's SIG patch (thanks as always).

Win32 now looks at the envirement variables when building the 
configuration defaults.  Thanks to net-dns-bug@oak-wood.co.uk 
(That's the only name I have... [cpan #1819])

Added Rob Brown's Net::DNS::Resolver::Recurse module.


*** 0.31 17 Nov 2002

Applied Olaf's patch for an initialization bug in OPT.pm

Applied Rob Brown's patch for udp timeouts.

Added stuff from Rob Brown for making RPM creation easier.

Fixed a typo in FAQ.pod that was making aropos and whatis
grumpy.  Thanks to Florian Hinzmann for pointing it out and a patch.


*** 0.30 7 Nov 2002

Applied Andrew Tridgell's (tridge@samba.org) patch for TKEY support.

Added Net::DNS::Packet->safe_push() to allow for automatically
checking for duplicate RRs being pushed into a packet.  Inspired by Luis
Munoz.

Added more tests.


*** 0.29 2 Oct 2002

Fixed $_ from creaping out of scope in Resolver.pm. Thanks to
Ilya Martynov for finding the problem and the patch to fix it.

Fixed divide by zero bug there is no usable network interface(s).
Thanks to twilliams@tfcci.com, misiek@pld.ORG.PL (and one other
person that I can't seem to find the address of) for reports. 
 

*** 0.28 20 Aug 2002

Fixed a bug in the new AUTOLOAD routines that made it impossible to set
attributes to '0'.

Fixed a bug in the RR pat that broke many updates. 


*** 0.27 15 Aug 2002

Added (untested) support for perl 5.004.

We now allow whitespace at the begining of a RR.

Fixed an issue that gave Net::DNS::SEC problems, %Net::DNS::RR::RR is now 
in a scope that the Net::DNS::SEC hook can see it from.

Fixed SRV records.

Fixed debug message in Net::DNS::Resolver::bgread().


*** 0.26 5 Aug 2002

Fixed various bugs in the test suite.

Fixed warning in Net::DNS::RR::AUTOLOAD with perl 5.005.

---
Olaf Kolkman <olaf@net-dns.org>
Chris Reinhardt 
Michael Fuhr 

$Id$
